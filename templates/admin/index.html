{% extends "admin/base_site.html" %}
{% load i18n static %}
{% load admin_menu %}
{% load leaflet_tags %}

{% block extrastyle %}
{{ block.super }}
<!-- <link rel="stylesheet" type="text/css" href="{% static 'admin/css/dashboard.css' %}" /> -->
{% leaflet_js %}
{% leaflet_css %}
<style type="text/css">
    #gis {width: 100%;height: 750px;}
</style>
<link rel="stylsheet" type="text/css" href="{% static 'leaflet-groupedlayercontrol/leaflet.groupedlayercontrol.min.css'%}">
<script type="text/javascript" src="{% static 'dist/leaflet.ajax.js'%}"></script>
<script type="text/javascript" src="{% static 'leaflet-groupedlayercontrol/leaflet.groupedlayercontrol.min.js'%}"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB2MmppHGfdrSzVXgDSPWVmOUVH-rwkI6M" async defer></script>
<script src="https://unpkg.com/leaflet.gridlayer.googlemutant@latest/dist/Leaflet.GoogleMutant.js"></script>
{% endblock %}

{% block coltype %}colMS{% endblock %}

{% block bodyclass %}{{ block.super }} dashboard{% endblock %}
{% if not is_popup %}
{% block breadcrumbs %}
<div class="row mb-2">
    <div class="col-sm-4">
        <h2>{{title}}</h2>
    </div>
    <div class="col-sm-8">
        <ol class="breadcrumb float-sm-right">
            <li class="breadcrumb-item"><a href="{% url 'admin:index' %}"><i class="fas fa-tachometer-alt"></i> {% trans 'Home' %}</a></li>
            {% for app in app_list %}
            <li class="breadcrumb-item active">{{ app.name }}</li>
            {% endfor %}
        </ol>
    </div>
</div>
{% endblock %}
{% endif %}

{% block content %}
<script type="text/javascript">
    function our_households(map,options){

        var basemaps = {
            OSM: L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
            }),
            GoogleSatellite: L.gridLayer
                        .googleMutant({
                            type: "satellite", // valid values are 'roadmap', 'satellite', 'terrain' and 'hybrid'
            }),
            GoogleRoadmap: L.gridLayer
                        .googleMutant({
                            type: "roadmap", // valid values are 'roadmap', 'satellite', 'terrain' and 'hybrid'
            })
        };

        var datasets = new L.GeoJSON.AJAX("{% url 'household'%}",{
            onEachFeature: function(feature,layer){
                layer.bindPopup(feature.properties.respondent.toString());
            }
        });
        
        var groupedOverlays = {
                "Databaset Layers": {
                    "Household": datasets,
                },           
            };
        //datasets.addTo(map);

        L.control.groupedLayers(basemaps, groupedOverlays).addTo(map);
    }
</script>
{% leaflet_map "gis" callback="window.our_households" %}
{% endblock %}